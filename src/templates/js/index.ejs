/*
    Launching the application and connecting the middlewares
*/

<% if(webFramework === 'express') { -%>
import express from 'express';
<% } -%>
import env from './config/env.js';
import middlewares from './middlewares/index.js';
import logger from './utils/logger.js';
    
<% if(webFramework === 'express') { -%>
const app = express();
<% } -%>
const serverPort = env.serverPort;

// Setup middlewares
<% if(database) { -%>
middlewares.setupDatabase();
<% } -%>
middlewares.setupSecurityHeaders(app);
middlewares.setupJsonParser(app);
middlewares.setupUrlEncodedParser(app);
middlewares.setupRequestID(app);
middlewares.setupRouters(app);
middlewares.setupNotFound(app);
middlewares.setupError(app);

// Start the server and listen on the specified port
app.listen(serverPort, () => {
    logger.info(`The server is started at the URL - localhost:${serverPort}`);
});
